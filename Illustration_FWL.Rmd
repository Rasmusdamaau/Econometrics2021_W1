---
title: "Illustration_FWL"
author: "Econometrics"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Demeaned Series

We generate the data, both regressor and regressand with mean different than zero.

```{r}
T = 100
x = rnorm(T, mean=2.5,sd=1)
eps = rnorm(T, mean=0,sd=1)
y = -1+3*x+eps
```

First, we estimate the model including the constant using raw data.

```{r}
lm.raw = lm(y~x)
summary(lm.raw)
```

Then, we demean the series and estimate the model on these data without the constant.

```{r}
xm = x-mean(x)
ym = y-mean(y)

lm.dem = lm(ym~xm-1)
summary(lm.dem)
```

The results show that the estimator for the parameter of the regressor is numerically the same in both regressions.

Moreover, we plot the residuals from both regressions to show that they are also numerically the same.

```{r}
plot(lm.raw$residuals,lm.dem$residuals)
```

## Groups of regressors

We generate the data, where the regressors are not orthogonal.

```{r}
x1 = rnorm(T,mean=2,sd=1)
x2 = 0.2*x1+rnorm(T,mean=-1,sd=1.5)
eps = rnorm(T,0,0.5)

y = x1+x2+eps
```

We estimate the regression with raw data and both regressors

```{r}
lm.both = lm(y~x1+x2)
summary(lm.both)
```

Then we clean the regressand and second regressor from the effect of the first regressor. To do so, we run both regressions and retrieve the residuals.

```{r}
lm.x2 = lm(x2~x1)
x2.cl = lm.x2$residuals

lm.y = lm(y~x1)
y.cl = lm.y$residuals
```

And we run the regressions on the "cleaned" data.

```{r}
lm.one = lm(y.cl~x2.cl-1)
summary(lm.one)
```

Plotting the residuals.

```{r}
plot(lm.both$residuals,lm.one$residuals)
```

